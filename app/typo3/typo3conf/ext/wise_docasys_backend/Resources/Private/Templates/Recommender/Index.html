{namespace wise=Wise\WiseDocasysBackend\ViewHelpers}

<f:layout name="Filter" />
<f:section name="content">
    <h1>Recommender</h1> 
    <h2>Vorauswahl von Lösungseigenschaften</h2>

    <f:form name="recommender-submit" action="index" method="post" style="width: 100%;" class="form-horizontal hidden-print">
        <div class="tab-content">
            <div class="tab-pane fade in {f:if(condition: '{results}', then: '', else: 'active')}">
                <div class="padding">
                    <div class="row form-group">
                        <label class="control-label col-sm-2">
                            Anwendungsfall:
                        </label>
                        <div class="col-sm-2">
                            <f:form.select property="operator.useCase" options="{operators}" class="form-control" value="{values.operator.useCase}" />
                        </div>
                        <div class="col-sm-8">
                            <f:form.select property="useCase" class="form-control" options="{wise:be.TcaOptions(property:'anwendungsfall',subject:'Wise\\WiseDocasysDomainDesigner\\Domain\\Model\\Loesung')}" value="{values.useCase}" />
                        </div>
                    </div>

                    <div class="row form-group">
                        <label class="control-label col-sm-2">
                            Flexibilit&auml;t:
                        </label>
                        <div class="col-sm-2">
                            <f:form.select property="operator.flexibility" options="{operators}" class="form-control" value="{values.operator.flexibility}" />
                        </div>
                        <div class="col-sm-8">
                            <f:form.select property="flexibility" class="form-control" options="{wise:be.TcaOptions(property:'flexibilitaet',subject:'Wise\\WiseDocasysDomainDesigner\\Domain\\Model\\Loesung')}" value="{values.flexibility}" />
                        </div>
                    </div>

                    <div class="row form-group">
                        <label class="control-label col-sm-2">
                            Invasivit&auml;tsgrad:
                        </label>
                        <div class="col-sm-2">
                            <f:form.select property="operator.invasivity" options="{operators}" class="form-control" value="{values.operator.invasivity}" />
                        </div>
                        <div class="col-sm-8">
                            <f:form.select property="invasivity" class="form-control" options="{wise:be.TcaOptions(property:'invasivitaetsgrad',subject:'Wise\\WiseDocasysDomainDesigner\\Domain\\Model\\Loesung')}" value="{values.invasivity}" />
                        </div>
                    </div>

                    <div class="row form-group">
                        <label class="control-label col-sm-2">
                            Wartungsintervall:
                        </label>
                        <div class="col-sm-2">
                            <f:form.select property="operator.maintenance" options="{operators}" class="form-control" value="{values.operator.maintenance}" />
                        </div>
                        <div class="col-sm-8">
                            <f:form.select property="maintenance" class="form-control" options="{wise:be.TcaOptions(property:'wartungsintervall',subject:'Wise\\WiseDocasysDomainDesigner\\Domain\\Model\\Loesung')}" value="{values.maintenance}" />
                        </div>
                    </div>

                    <div class="row form-group">
                        <label class="control-label col-sm-2">
                            Zugriff auf Maschinensteuerung:
                        </label>
                        <div class="col-sm-2">
                            <f:form.select property="operator.machineControlAccess" options="{operators}" class="form-control" value="{values.operator.machineControlAccess}" />
                        </div>
                        <div class="col-sm-8">
                            <f:form.select property="machineControlAccess" class="form-control" options="{wise:be.TcaOptions(property:'maschinensteuerungszugriff',subject:'Wise\\WiseDocasysDomainDesigner\\Domain\\Model\\Loesung')}" value="{values.machineControlAccess}" />
                        </div>
                    </div>

                    <div class="row form-group">
                        <label class="control-label col-sm-2">
                            Notwendigkeit Maschinenstillstand:
                        </label>
                        <div class="col-sm-2">
                            <f:form.select property="operator.machineStopRequired" options="{operators}" class="form-control" value="{values.operator.machineStopRequired}" />
                        </div>
                        <div class="col-sm-8">
                            <f:form.select property="machineStopRequired" class="form-control" options="{wise:be.TcaOptions(property:'maschinenstillstandsnotwendigkeit',subject:'Wise\\WiseDocasysDomainDesigner\\Domain\\Model\\Loesung')}" value="{values.machineStopRequired}" />
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-footer-submit">
            <div class="row">
                <div class="col-sm-6"> 
                    <div class="padding">
                        <a href="{f:uri.action(action:'index')}" class="btn btn-info">Recommender Eingaben zur&uuml;cksetzen</a>
                    </div> 
                </div> 
                <div class="col-sm-6"> 
                    <div class="right padding">
                        <f:form.submit value="Recommender Eingaben Suchen" class="btn btn-primary" />
                    </div>
                </div>  
            </div>
        </div>
    </f:form>

    <f:if condition="{results}">
        <div class="page-header">
            <h2>
                Ergebnisliste <span class="label label-primary"><f:count>{results}</f:count> Treffer</span>
            </h2>
        </div>
        <div class="table-fit">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <td>Teilprojektnummer</td>
                        <td>Lösungsbezeichnung</td>
                        <td>Nettofluss</td>
                    </tr>
                </thead>
                <tbody>
                    <f:for each="{results}" as="solution">
                        <tr>
                            <td style="width: 15%">{solution.teilprojektnummer}</td>
                            <td style="width: 30%">
                                <wise:be.editLink parameters="edit[tx_wisedocasysdomaindesigner_domain_model_loesung][{solution.uid}]=edit">
                                {solution.loesungsbezeichnung}
                            </wise:be.editLink>
                            </td>
                            <td>{solution.nettofluss}</td>
                        </tr>
                    </f:for>
                </tbody>
            </table>
        </div>
        
        <head>
            <style>
                * {
                    margin: 0;
                    padding: 0;
                    font-family: sans-serif;
                }
                .chartBox {
                    width: 700px;
                    padding: 20px;
                    border-radius: 20px;
                    border: solid 3px rgba(255, 26, 104, 0.5);
                    background: white;
                }
            </style>
        </head>
        
        <body>
            <div class="chartBox">
                <canvas id="myChart"></canvas>
            </div>
            <f:for each="{labels}" as="label">
                {label}
            </f:for>
            <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js"></script>
            <script>
                // data 
                var data = {
                    min: -1, 
                    max: 1,
                    labels: ['<f:format.raw>{labels}</f:format.raw>'],
                    // labels: 'labels',
                    datasets: [
                        {
                            label: 'Ausgangsfluss',
                            data: [0.86,0.25,-0.14,-0.14,-0.33,-0.49],
                            backgroundColor: 'rgba(255, 26, 104, 0.4)',
                            borderWidth: 1
                        },
                        {
                            label: 'Eingangsfluss',
                            data: [0.86,0.25,-0.14,-0.14,-0.33,-0.49],
                            backgroundColor: 'rgba(54, 162, 235, 0.4)',
                            borderWidth: 1
                        }
                    ]
                };
                // config 
                var config = {
                    type: 'bar',
                    data: data,
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            title: {
                                display: true,
                                text: 'Vertical Bar Chart'
                            }
                        }
                    },
                };
                // render init block
                var myChart = new Chart(
                    document.getElementById('myChart'),
                    config
                );
            </script>

        </body>
    </f:if>
    
</f:section>
